#include "./eosInteractorMyStyle.hh"
#include "./eosStereoModeOn.hh"

eosStereoModeOn::eosStereoModeOn(){
  this->init();
}

void eosStereoModeOn::init0() {
  camLeft=vtkCamera::New();
  camRight=vtkCamera::New();
  renLeft=vtkRenderer::New();
  renRight=vtkRenderer::New();
  renWinStereo=vtkRenderWindow::New();
  irenStereo=vtkRenderWindowInteractor::New();

  renLeft->SetViewport(0,0,0.5,1.0);
  renLeft->SetActiveCamera(camRight);
  renRight->SetViewport(0.5,0,1.0,1.0);
  renRight->SetActiveCamera(camLeft);

  renWinStereo->AddRenderer(renLeft);
  renWinStereo->AddRenderer(renRight);
  //renWinStereo->SetStereoType(5);
  renWinStereo->SetWindowName("StereoWindow(cross eye mode)");
  renWinStereo->SetSize(600,300);
  irenStereo->SetRenderWindow(renWinStereo);
}

void eosStereoModeOn::init(){
  init0();
  myiStereo=eosInteractorMyStyle::New();
  irenStereo->SetInteractorStyle(myiStereo);
}

eosStereoModeOn::~eosStereoModeOn(){
  //delete this->camLeft;
  //delete this->camRight;
  this->renLeft->Clear();
  this->renRight->Clear();
  //delete this->renWinStereo;
  //delete this->irenStereo;
  //delete this->myiStereo;
}

eosStereoModeOn *eosStereoModeOn::New()
{
  return new eosStereoModeOn;
}

void eosStereoModeOn::eosStereoModeOnSet(vtkRenderWindow* renwin){

    renWin=renwin;
    ren=(vtkRenderer*)renWin->GetRenderers()->GetItemAsObject(0);

    /***** set up cameras *****/
    cam=ren->GetActiveCamera();
    camRight->SetFocalPoint(cam->GetFocalPoint());
    camRight->SetPosition(cam->GetPosition());
    camRight->SetEyeAngle(cam->GetEyeAngle());
    camLeft->SetFocalPoint(cam->GetFocalPoint());
    camLeft->SetPosition(cam->GetPosition());
    camLeft->SetEyeAngle(cam->GetEyeAngle());

    /***** set up Renderers *****/
    renLeft->AddLight((vtkLight*)ren->GetLights()->GetItemAsObject(0));
    renLeft->AddActor((vtkActor*)ren->GetActors()->GetItemAsObject(0));
    
    renRight->AddLight((vtkLight*)ren->GetLights()->GetItemAsObject(0));
    renRight->AddActor((vtkActor*)ren->GetActors()->GetItemAsObject(0));

    /***** create and set up StereoRenderWindow *****/
  
    /***** set up StereoInteractor *****/

    /***** call myInteractor *****/
    //myiStereo->SetStereoRenderWindows(renLeft,renRight,irenStereo);
    //myiStereo->SetStereoWindow();

}


vtkRenderer* eosStereoModeOn::GetRendererRight(void)
{
  return(this->renRight);
}
vtkRenderer* eosStereoModeOn::GetRendererLeft(void)
{
  return(this->renLeft);
}
vtkRenderWindowInteractor* eosStereoModeOn::GetStereoWindowInteractor(void)
{
  return(this->irenStereo);
}

vtkRenderWindow* eosStereoModeOn::GetStereoWindow(void)
{
  return(this->renWinStereo);
}

void eosStereoModeOn::ShowWindow(void)
{
  this->irenStereo->Render();
}

void
additionalUsage()
{
	fprintf(stderr, "----- Additional Usage -----\n");
}
